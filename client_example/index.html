<html>
	<head>
		<meta charset="utf-8" />
		<link id="favicon" rel="shortcut icon" type="image/png" href="data:image/png;base64,....==" />
		<title>FreeCycle Example Client</title>
<style>

html, body {
	font-family: Arial, Helvetica, sans-serif;
	margin: 0;
	padding: 0;
}
a {
	color: inherit;
	text-decoration: inherit;
}

#nav div {
	display: inline-block;
}

#nav h1 {
	margin: 0;
	padding: 0;
	display: inline-block;
}

#menu li {
	display: inline-block;
}

#user {
	float: right;
}

#main {

}

#templates {
	display: none;
}

</style>
	</head>
	<body>
		<div id="nav">
			<div id="logo">
				<a href="#">
					&#128205; <!-- Unicode for Map Pin - https://unicode-table.com/en/1F4CD/ -->
					<h1>FreeCycle</h1>
				</a>
			</div>
			<div id="menu">
				<ul>
					<li>
						<a href="#items">Items</a>
					</li>
					<li>
						<a href="#create">Create</a>
					</li>
				</ul>
			</div>
			<div id="user">
				<a href="#signin">Sign in</a>
			</div>
		</div>

		<div id="main">

		</div>

		<div id="templates">

			<div class="unknown">
				Unknown page
			</div>

			<div class="about">
				Welcome
			</div>

			<div class="items">
				List items
			</div>

			<div class="create">
				Create item
			</div>

			<div class="signin">
				<form>
					<input type="text" name="username" placeholder="username">
					<input type="password" name="password">
					<input type="submit" id="action_signin" onclick="event.preventDefault(); console.log('todo');">
				</form>
			</div>

		</div>
<script type="module">
	const urlParams = new URLSearchParams(window.location.search);

	//let username = window.localStorage.getItem("username");
	/// window.localStorage.setItem("paratrooper", JSON.stringify(data));


	function clear_node(node) {
		let child;
		while (child = node.lastElementChild) {
			node.removeChild(child);
		}
	}

	function render_template({name="#unknown", requires_login=false}={}) {
		console.log('render_template', name);
		if (requires_login && !window.localStorage.getItem("username")) {
			name = '#signin';
		}
		name = name.replace('#','');
		const newClone = document.getElementById('templates').getElementsByClassName(name)[0].cloneNode(true);  // https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode
		const main = document.getElementById('main');
		clear_node(main);
		main.appendChild(newClone);
	}
	const RENDERERS = {
		"":()=>render_template({name: '#about'}),
		"#signin"  : ()=>render_template({name: '#signin'}),
		"#items": ()=>render_template({name: '#items'}),
		"#create": ()=>render_template({name: '#create', requires_login: true}),
	};

	// Hash router
	function hashchange() {
		console.log('hashchange', window.location.hash);
		(RENDERERS[window.location.hash] || render_template)();
	}
	window.addEventListener('hashchange', hashchange);
	

	// First load
	hashchange();

	/*
	fetch(`subject-knowledge.json`)
		.then(response => response.json())
		.then((data)=>_data=data)
		.then(renderData)
	.catch(err => console.error(err));
	*/

</script>
	</body>
</html>